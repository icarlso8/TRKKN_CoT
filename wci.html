<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex, nofollow">
  <title>TRKKN_CoT - WhatsApp Conversion Import</title>
  <link rel="icon" href="assets/TRKKN_icon.png" type="image/png" />

  <!-- Oculta el body hasta que est√© autenticado -->
  <style>body { display: none !important; }</style>

  <!-- Carga Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.1/firebase-auth.js"></script>
  <!-- Inicializa Firebase y deja auth global -->
  <script src="./firebase-init.js"></script>

  <!-- Protecci√≥n de acceso -->
  <script>
    console.log("‚è≥ Esperando a que Firebase se inicialice...");
  
    document.addEventListener("DOMContentLoaded", () => {
      const waitForAuth = () => {
        if (window.auth && typeof window.auth.onAuthStateChanged === "function") {
          console.log("‚úÖ Firebase listo. Protegiendo acceso...");
          window.auth.onAuthStateChanged(user => {
            if (!user) {
              console.warn("üö´ Usuario no autenticado. Redirigiendo a auth.html...");
              alert("‚ö†Ô∏è Inicia sesi√≥n Trkkie!");
              window.location.href = "auth.html";
            } else {
              console.log("‚úÖ Usuario autenticado:", user.email);
              document.body.style.display = "block";
            }
          });
        } else {
          console.log("‚ùå window.auth a√∫n no disponible. Reintentando...");
          setTimeout(waitForAuth, 100);
        }
      };
  
      waitForAuth();
    });
  </script>
  
  <script>
    window.addEventListener("DOMContentLoaded", () => {
      // ‚úÖ Usa window.auth, que ya viene de firebase-init.js
      window.auth.onAuthStateChanged(user => {
        if (!user) {
          alert("‚ö†Ô∏è Inicia sesi√≥n Trkkie!");
          window.location.href = "auth.html";
        } else {
          document.body.style.display = "block";
        }
      });
    });
  </script>
</head>
<body>
  <h2>Vista de demostraci√≥n de WCI (WhatsApp Conversion Import)</h2>
  <p>En construcci√≥n...</p>
</body>
</html>
